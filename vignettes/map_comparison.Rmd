---
title: "The Accuracy of Human Population Density Maps : Detailed Methods"
author: "David L Smith, Carlos Guerra, Andrew Dolgert, Brendan Fries"
date: "9/18/2019"
output:
  pdf_document: default
  html_document: default
---

# Overview

This notebook calculates metrics from a population density map
by comparing them with a gold standard map.

# Maps

The maps were made by the "get-data" vignette. We load them all
at once here for convenience. The naming scheme is dataset-on-grid,
where grids are 100m or 1km, according to where they come from.

```{r load_maps}
project_root <- rprojroot::find_root(rprojroot::is_rstudio_project)
map_root <- fs::path(project_root, "inst", "extdata", "aligned")
files <- list.files(map_root, pattern = "*.tif$")

file_identifier <- function(name) {
  splitted <- strsplit(name, "[_.]")[[1]]
  identifier <- list(grid = splitted[[1]], source = splitted[[2]])
  identifier$resolution <- ifelse(endsWith(identifier$grid, "100"), 100, 1000)
  identifier
}
map_ids <- lapply(files, file_identifier)
descriptive_name <- sapply(map_ids, function(x) paste(x$source, "on", x$grid))
names(map_ids) <- descriptive_name
maps <- lapply(files, function(x) raster::raster(fs::path(map_root, x)))
names(maps) <- descriptive_name
```

# Summary Statistics

The first figure is summary statistics, done at the pixel level.

```{r summary_statistics}
summary_stats <- lapply(maps, summary_statistics)
summary_df <- do.call(rbind, summary_stats)
rownames(summary_df) <- names(maps)
t(summary_df)
```

